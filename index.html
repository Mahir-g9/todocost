<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TodoCost - Online Cost To Do List</title>
<meta name="description" content="Manage your tasks and costs easily with TodoCost, the online cost to do list app.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    :root {
  --primary: #4361ee;
  --primary-dark: #3a56d4;
  --secondary: #3f37c9;
  --accent: #4895ef;
  --danger: #f72585;
  --success: #4cc9f0;
  --light: #f8f9fa;
  --dark: #212529;
  --gray: #6c757d;
  --transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
  --shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
  --focus-glow: 0 0 0 4px rgba(67, 97, 238, 0.15);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: var(--light);
  color: var(--dark);
  line-height: 1.6;
  overflow-x: hidden;
}

/* ===== AUTH CONTAINER ===== */
.auth-container {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 2rem;
  background: linear-gradient(-45deg, #4361ee, #3f37c9, #4895ef, #4cc9f0);
  background-size: 400% 400%;
  animation: gradientBG 18s ease infinite;
}

@keyframes gradientBG {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.auth-card {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 20px;
  width: 100%;
  overflow: hidden;
  box-shadow: var(--shadow);
  animation: cardAppear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  backdrop-filter: blur(4px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

@keyframes cardAppear {
  0% {
    opacity: 0;
    transform: translateY(40px) scale(0.95);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* ===== LOGO HEADER ===== */
.logo-header {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
  padding: 2.5rem 2rem;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  overflow: hidden;
}

.logo-header::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
  transform: rotate(30deg);
}

.logo-header i {
  font-size: 2.5rem;
  margin-bottom: 1rem;
  background: white;
  color: var(--primary);
  width: 80px;
  height: 80px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
  z-index: 1;
  transition: var(--transition);
}

.logo-header:hover i {
  transform: translateY(-5px) rotate(10deg);
  box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
}

.logo-header h1 {
  font-weight: 600;
  font-size: 1.8rem;
  margin-top: 0.5rem;
  z-index: 1;
  text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* ===== FORMS ===== */
.forms-container {
  padding: 2.5rem;
  position: relative;
  min-height: 90vh;
}

.auth-form {
  position: absolute;
  width: calc(100% - 5rem);
  transition: var(--transition);
  opacity: 0;
  pointer-events: none;
  transform: translateX(30px);
}

.auth-form.active {
  opacity: 1;
  pointer-events: all;
  transform: translateX(0);
}

.auth-form h2 {
  margin-bottom: 1.5rem;
  color: var(--dark);
  font-weight: 600;
  text-align: center;
  position: relative;
  padding-bottom: 10px;
}

.auth-form h2::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 50px;
  height: 3px;
  background: var(--accent);
  border-radius: 2px;
}

/* ===== INPUT GROUPS ===== */
.input-group {
  position: relative;
  margin-bottom: 1.8rem;
}

.input-group i {
  position: absolute;
  left: 18px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--gray);
  transition: var(--transition);
  z-index: 2;
}

.input-group input {
  width: 100%;
  padding: 16px 20px 16px 52px;
  border: 2px solid #e9ecef;
  border-radius: 12px;
  font-size: 1rem;
  transition: var(--transition);
  background: #f8f9fa;
  position: relative;
  z-index: 1;
}

.input-group input:focus {
  border-color: var(--primary);
  background: white;
  outline: none;
  box-shadow: var(--focus-glow);
  transform: translateY(-2px);
}

.input-group input:focus + i {
  color: var(--primary);
  transform: translateY(-50%) scale(1.1);
}

.input-group input::placeholder {
  color: #adb5bd;
  font-weight: 300;
}

.toggle-password {
  left: auto !important;
  right: 18px;
  cursor: pointer;
  transition: transform 0.3s ease;
}

.toggle-password:hover {
  transform: translateY(-50%) scale(1.15);
}

/* ===== BUTTONS ===== */
.auth-btn {
  background: linear-gradient(to right, var(--primary), var(--accent));
  color: white;
  border: none;
  width: 100%;
  padding: 16px;
  border-radius: 12px;
  font-size: 1.05rem;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  transition: var(--transition);
  margin-top: 1.2rem;
  position: relative;
  overflow: hidden;
  box-shadow: 0 6px 15px rgba(67, 97, 238, 0.3);
}

.auth-btn::after {
  content: '';
  position: absolute;
  top: -50%;
  left: -60%;
  width: 20px;
  height: 200%;
  background: rgba(255,255,255,0.3);
  transform: rotate(25deg);
  transition: all 0.6s ease;
}

.auth-btn:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 10px 25px rgba(67, 97, 238, 0.4);
}

.auth-btn:hover::after {
  left: 120%;
}

.auth-btn:active {
  transform: translateY(1px) scale(0.98);
}

.text-btn {
  background: none;
  border: none;
  color: var(--primary);
  cursor: pointer;
  padding: 0;
  font-size: 0.95rem;
  width: 100%;
  text-align: left;
  margin-top: 0.8rem;
  display: inline-block;
  position: relative;
  width: auto;
}

.text-btn::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 0;
  height: 1px;
  background: var(--primary);
  transition: width 0.4s ease;
}

.text-btn:hover::after {
  width: 100%;
}

/* ===== FORM FOOTER ===== */
.form-footer {
  text-align: center;
  margin-top: 1.8rem;
  color: var(--gray);
  font-size: 0.95rem;
}

.form-footer a {
  color: var(--primary);
  text-decoration: none;
  font-weight: 500;
  transition: var(--transition);
  position: relative;
}

.form-footer a::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 0;
  height: 1px;
  background: var(--primary);
  transition: width 0.4s ease;
}

.form-footer a:hover::after {
  width: 100%;
}

/* ===== ERROR MESSAGE ===== */
.error-message {
  background: rgba(247, 37, 133, 0.08);
  color: var(--danger);
  padding: 1.2rem;
  margin: 0 2rem 2rem;
  border-radius: 12px;
  text-align: center;
  font-weight: 500;
  display: none;
  animation: shake 0.6s, fadeIn 0.4s;
  border: 1px solid rgba(247, 37, 133, 0.2);
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-8px); }
  40%, 80% { transform: translateX(8px); }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== DASHBOARD STYLES ===== */
#user-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 2rem;
  animation: fadeIn 0.8s ease;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2.5rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid rgba(0,0,0,0.08);
}

.sign-out-btn {
  background: linear-gradient(to right, var(--danger), #e5177e);
  color: white;
  border: none;
  padding: 0.7rem 1.4rem;
  border-radius: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: var(--transition);
  box-shadow: 0 4px 12px rgba(247, 37, 133, 0.25);
}

.sign-out-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 7px 18px rgba(247, 37, 133, 0.35);
}

.sign-out-btn:active {
  transform: translateY(1px);
}

/* ===== CONTROLS ===== */
.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  margin-bottom: 2rem;
}

.controls select, .controls input {
  padding: 0.8rem 1.2rem;
  border: 1px solid #ddd;
  border-radius: 10px;
  flex-grow: 1;
  transition: var(--transition);
  font-size: 1rem;
  background: white;
}

.controls select:focus, .controls input:focus {
  border-color: var(--accent);
  box-shadow: var(--focus-glow);
  outline: none;
  transform: translateY(-2px);
}

.controls button {
  padding: 0.8rem 1.8rem;
  background: linear-gradient(to right, var(--primary), var(--accent));
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: var(--transition);
  font-weight: 500;
  letter-spacing: 0.5px;
  box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
}

.controls button:hover {
  transform: translateY(-3px) scale(1.03);
  box-shadow: 0 7px 20px rgba(67, 97, 238, 0.4);
}

.summary {
  display: flex;
  align-items: center;
  gap: 1.5rem;
  margin-top: 1.5rem;
  width: 100%;
  padding: 1.2rem;
  background: white;
  border-radius: 12px;
  box-shadow: var(--shadow);
  animation: fadeIn 0.6s ease;
}

/* ===== TASK LIST ===== */
#task-list {
  list-style: none;
  animation: fadeIn 0.7s ease;
}

#task-list li {
  background: white;
  padding: 1.2rem 1.5rem;
  margin-bottom: 0.8rem;
  border-radius: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
  transition: var(--transition);
  border-left: 4px solid var(--accent);
}

#task-list li:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
}

#task-list li span {
  flex-grow: 1;
  font-weight: 500;
}

#task-list li button {
  background: var(--danger);
  color: white;
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  cursor: pointer;
  margin-left: 0.8rem;
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 3px 8px rgba(247, 37, 133, 0.3);
}

#task-list li button:hover {
  transform: scale(1.15) rotate(10deg);
  box-shadow: 0 5px 12px rgba(247, 37, 133, 0.4);
}

/* ===== MODAL ===== */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.6);
  z-index: 1000;
  justify-content: center;
  align-items: center;
  animation: fadeIn 0.3s ease;
}

.modal-content {
  background: white;
  padding: 2.5rem;
  border-radius: 16px;
  width: 90%;
  max-width: 450px;
  position: relative;
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
  animation: modalAppear 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes modalAppear {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.close-modal {
  position: absolute;
  right: 20px;
  top: 15px;
  font-size: 28px;
  cursor: pointer;
  color: var(--gray);
  transition: var(--transition);
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

.close-modal:hover {
  color: var(--danger);
  transform: rotate(90deg) scale(1.1);
  background: rgba(247, 37, 133, 0.08);
}

.modal-content h3 {
  margin-bottom: 1.5rem;
  text-align: center;
  font-size: 1.5rem;
  color: var(--dark);
  position: relative;
  padding-bottom: 12px;
}

.modal-content h3::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: 3px;
  background: var(--accent);
  border-radius: 2px;
}

.modal-content input {
  width: 100%;
  padding: 1rem 1.5rem;
  margin-bottom: 1.5rem;
  border: 2px solid #e9ecef;
  border-radius: 12px;
  font-size: 1rem;
  transition: var(--transition);
}

.modal-content input:focus {
  border-color: var(--primary);
  box-shadow: var(--focus-glow);
  outline: none;
  transform: translateY(-2px);
}

.modal-content button {
  width: 100%;
  padding: 1rem;
  background: linear-gradient(to right, var(--primary), var(--accent));
  color: white;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  margin-top: 1rem;
  font-size: 1.05rem;
  font-weight: 600;
  transition: var(--transition);
  box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
}

.modal-content button:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(67, 97, 238, 0.4);
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .auth-container {
    padding: 1rem;
  }

  .auth-card {
    border-radius: 18px;
    max-width: 95%;
  }

  .logo-header {
    padding: 2rem 1.5rem;
  }

  .forms-container {
    padding: 2rem 1.5rem;
  }

  .controls {
    flex-direction: column;
  }

  .controls select,
  .controls input,
  .controls button {
    width: 100%;
  }

  .modal-content {
    padding: 2rem 1.5rem;
  }
}

/* ===== LOADING ANIMATION ===== */
@keyframes float {
  0% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0); }
}

/* ===== UTILITY ANIMATIONS ===== */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes floatIcon {
  0% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
  100% { transform: translateY(0); }
}

/* Apply floating animation to logo */
.logo-header i {
  animation: floatIcon 4s ease-in-out infinite;
}
/* Add to :root */
:root {
  --warning: #ff9e00; /* New warning color */
  --warning-dark: #e68e00;
}

/* Edit button styles */
.icon-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 3px 8px rgba(0,0,0,0.15);
  font-size: 0.9rem;
  position: relative;
  overflow: hidden;
}

.icon-btn::after {
  content: '';
  position: absolute;
  top: -50%;
  left: -100%;
  width: 40%;
  height: 200%;
  background: rgba(255,255,255,0.2);
  transform: rotate(25deg);
  transition: all 0.6s ease;
}

.icon-btn:hover::after {
  left: 150%;
}

.edit-btn {
  background: var(--warning);
  box-shadow: 0 4px 10px rgba(255, 158, 0, 0.3);
}

.edit-btn:hover {
  background: var(--warning-dark);
  transform: scale(1.15) rotate(-8deg);
  box-shadow: 0 6px 15px rgba(255, 158, 0, 0.4);
}

.edit-btn i {
  transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
}

.edit-btn:hover i {
  transform: scale(1.2) rotate(10deg);
}

/* Animation for edit action */
@keyframes pencilWrite {
  0% { transform: translateY(0) rotate(0); }
  25% { transform: translateY(-3px) rotate(-5deg); }
  50% { transform: translateY(0) rotate(5deg); }
  75% { transform: translateY(2px) rotate(-3deg); }
  100% { transform: translateY(0) rotate(0); }
}

.edit-btn:active i {
  animation: pencilWrite 0.5s ease;
}
#logo {
  font-family: 'Poppins', sans-serif;
  font-weight: 700;
  font-size: 2.5rem;
  background: linear-gradient(135deg, #4361ee, #3f37c9);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 4px 10px rgba(67, 97, 238, 0.2);
  position: relative;
  display: inline-block;
  padding: 0.5rem 1rem;
  margin: 0;
  line-height: 1.2;
  letter-spacing: -0.5px;
  animation: logoFloat 3s ease-in-out infinite;
  -webkit-text-stroke: 2px white; text-stroke: 2px white;
}

#logo::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 15px;
  background: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(63, 55, 201, 0.05));
  transform: perspective(500px) rotateX(10deg);
  z-index: -1;
  opacity: 0.8;
}

#logo::after {
  content: '©';
  position: absolute;
  right: -10px;
  top: -15px;
  font-size: 1.8rem;
  color: #4cc9f0;
  text-shadow: 0 2px 5px rgba(76, 201, 240, 0.3);
  animation: checkPulse 2s ease-in-out infinite;
}

@keyframes logoFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

@keyframes checkPulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.2); opacity: 0.8; }
}
#logo:hover {
  animation: logoFloat 1s ease-in-out infinite, gradientShift 8s ease infinite;
}
button {
  box-shadow: 10px 10px 10px #1CA5FF5C;
  animation: gradientBG 18s ease infinite;
}
</style>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="logo-header">
                <i class="fas fa-lock"></i>
                <h1 id="logo">TodoCost</h1>
            </div>
            
            <div class="forms-container">
                <!-- Login Form -->
                <form id="login-form" class="auth-form active">
                    <h2>Login</h2>
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="login-email" placeholder="Email" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="login-password" placeholder="Password" required>
                        <i class="fas fa-eye toggle-password"></i>
                    </div>
                    <button type="submit" class="auth-btn">Login</button>
                    <a href="forgot.html" id="forgot-password" class="text-btn">Forgot password?</a>
                    <p class="form-footer">
                        Don't have an account? <a href="#" id="show-signup">Sign Up</a>
                    </p>
                </form>

                <!-- Signup Form -->
                <form id="signup-form" class="auth-form">
                    <h2>Sign Up</h2>
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="signup-name" placeholder="Full Name" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="signup-email" placeholder="Email" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="signup-password" placeholder="Password" required>
                        <i class="fas fa-eye toggle-password"></i>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="signup-confirm" placeholder="Confirm Password" required>
                    </div>
                    <button type="submit" class="auth-btn">Sign Up</button>
                    <p class="form-footer">
                        Already have an account? <a href="#" id="show-login">Login</a>
                    </p>
                </form>
            </div>
            
            <div id="auth-error" class="error-message"></div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="user-container" style="display: none;">
        <div class="header">
            <h1 id="logo">TodoCost</h1>
            <button id="sign-out-btn" class="sign-out-btn">
                <i class="fas fa-sign-out-alt"></i> Sign Out
            </button>
        </div>
        
        <div class="controls">
            <select id="input-type">
                <option value="text">Text Note</option>
                <option value="number">Cost Entry</option>
            </select>
            
            <input type="text" id="task-input" placeholder="Description">
            <input type="number" id="cost-input" placeholder="Amount" style="display: none;">
            <button id="add-task-btn">Add</button>
            
            <div class="summary">
                <span id="total-display">Total: $0.00</span>
                <button id="calculate-btn">Calculate</button>
                <button id="delete-all-btn">Delete All</button>
            </div>
        </div>

        <ul id="task-list"></ul>

        <!-- Reset Password Modal -->
        <div id="reset-modal" class="modal">
            <p>hi</p>
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h3>Reset Password</h3>
                <input type="email" id="reset-email" placeholder="Your email">
                <button id="send-code-btn">Send Verification Code</button>
                <div id="code-section" style="display:none;">
                    <input type="text" id="verification-code" placeholder="Enter code">
                    <input type="password" id="new-password" placeholder="New password">
                    <button id="verify-code-btn">Reset Password</button>
                </div>
                <p id="reset-error" class="error-message"></p>
            </div>
        </div>
    </div>

    <script>document.addEventListener('DOMContentLoaded', function() {
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCvF2BV5MBU6AMQOByD9Q5g4wZXF0a9W1g",
        authDomain: "movement-player.firebaseapp.com",
        projectId: "movement-player",
        storageBucket: "movement-player.appspot.com",
        messagingSenderId: "55543297155",
        appId: "1:55543297155:web:b8ef612f7041bcab7617b6",
        measurementId: "G-0PPZM7EXZM"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // DOM Elements
    const loginForm = document.getElementById('login-form');
    const signupForm = document.getElementById('signup-form');
    const showSignup = document.getElementById('show-signup');
    const showLogin = document.getElementById('show-login');
    const authError = document.getElementById('auth-error');
    const authContainer = document.querySelector('.auth-container');
    const userContainer = document.getElementById('user-container');
    const userEmailElement = document.getElementById('user-email');
    const forgotPasswordLink = document.getElementById('forgot-password');
    const resetModal = document.getElementById('reset-modal');
    const closeModal = document.querySelector('.close-modal');
    const sendCodeBtn = document.getElementById('send-code-btn');
    const verifyCodeBtn = document.getElementById('verify-code-btn');
    const codeSection = document.getElementById('code-section');
    const resetError = document.getElementById('reset-error');
    const taskInput = document.getElementById('task-input');
    const costInput = document.getElementById('cost-input');
    const addTaskBtn = document.getElementById('add-task-btn');
    const taskList = document.getElementById('task-list');
    const totalDisplay = document.getElementById('total-display');
    const calculateBtn = document.getElementById('calculate-btn');
    const deleteAllBtn = document.getElementById('delete-all-btn');
    const inputTypeSelect = document.getElementById('input-type');
    const signOutBtn = document.getElementById('sign-out-btn');

    let tasksRef;
    const verificationCodes = {};

    // Password Visibility Toggle
    document.querySelectorAll('.toggle-password').forEach(icon => {
        icon.addEventListener('click', function() {
            const input = this.previousElementSibling;
            const isPassword = input.type === 'password';
            input.type = isPassword ? 'text' : 'password';
            this.classList.toggle('fa-eye-slash', isPassword);
            this.classList.toggle('fa-eye', !isPassword);
        });
    });

    // Form Switching
    showSignup.addEventListener('click', function(e) {
        e.preventDefault();
        loginForm.classList.remove('active');
        setTimeout(() => {
            signupForm.classList.add('active');
        }, 300);
        clearError();
    });

    showLogin.addEventListener('click', function(e) {
        e.preventDefault();
        signupForm.classList.remove('active');
        setTimeout(() => {
            loginForm.classList.add('active');
        }, 300);
        clearError();
    });

    // Error Handling
    function showError(message) {
        authError.textContent = message;
        authError.style.display = 'block';
        setTimeout(() => {
            authError.style.animation = 'none';
            void authError.offsetWidth; // Trigger reflow
            authError.style.animation = 'shake 0.5s';
        }, 10);
    }

    function clearError() {
        authError.style.display = 'none';
        authError.style.animation = 'none';
    }

    // Login Function
    loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('login-email').value;
        const password = document.getElementById('login-password').value;

        if (!email || !password) {
            showError('Please fill in all fields');
            return;
        }

        auth.signInWithEmailAndPassword(email, password)
            .then(() => {
                clearError();
            })
            .catch((error) => {
                showError(getErrorMessage(error.code));
            });
    });

    // Signup Function
    signupForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const name = document.getElementById('signup-name').value;
        const email = document.getElementById('signup-email').value;
        const password = document.getElementById('signup-password').value;
        const confirmPassword = document.getElementById('signup-confirm').value;

        if (!name || !email || !password || !confirmPassword) {
            showError('Please fill in all fields');
            return;
        }

        if (password !== confirmPassword) {
            showError('Passwords do not match');
            return;
        }

        if (password.length < 6) {
            showError('Password must be at least 6 characters');
            return;
        }

        auth.createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
                return userCredential.user.updateProfile({
                    displayName: name
                });
            })
            .then(() => {
                clearError();
            })
            .catch((error) => {
                showError(getErrorMessage(error.code));
            });
    });

    inputTypeSelect.addEventListener('change', function() {
        costInput.style.display = this.value === 'number' ? 'block' : 'none';
    });

    function initCostTracker(user) {
        tasksRef = db.collection('users').doc(user.uid).collection('costs');
        
        addTaskBtn.addEventListener('click', addCost);
        taskInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') addCost();
        });

        function addCost() {
            const description = taskInput.value.trim();
            const inputType = inputTypeSelect.value;
            
            if (!description) {
                alert('Please enter a description');
                return;
            }

            const costData = {
                description: description,
                type: inputType,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };

            if (inputType === 'number') {
                const amount = parseFloat(costInput.value) || 0;
                costData.amount = amount;
            }

            tasksRef.add(costData)
                .then(() => {
                    taskInput.value = '';
                    costInput.value = '';
                })
                .catch(error => {
                    console.error("Error adding cost: ", error);
                });
        }

        // Load and display costs
        tasksRef.orderBy('createdAt', 'desc').onSnapshot(snapshot => {
            taskList.innerHTML = '';
            let total = 0;

            snapshot.forEach(doc => {
                const cost = doc.data();
                const li = document.createElement('li');
                li.dataset.id = doc.id;

// Edit button creation in JavaScript
const editBtn = document.createElement('button');
editBtn.innerHTML = '<i class="fas fa-pencil-alt"></i>'; // More appropriate edit icon
editBtn.className = 'icon-btn edit-btn'; // Added specific class for styling
editBtn.addEventListener('click', () => editCost(doc.id, cost));

                // Delete button
                const deleteBtn = document.createElement('button');
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.className = 'icon-btn';
                deleteBtn.style.background = 'var(--danger)';
                deleteBtn.addEventListener('click', () => deleteCost(doc.id));

                // Cost item content
                const span = document.createElement('span');
                if (cost.type === 'number') {
                    span.textContent = `${cost.description}: $${cost.amount?.toFixed(2) || '0.00'}`;
                    total += cost.amount || 0;
                } else {
                    span.textContent = cost.description;
                }

                li.appendChild(span);
                li.appendChild(editBtn);
                li.appendChild(deleteBtn);
                taskList.appendChild(li);
            });

            totalDisplay.textContent = `Total: $${total.toFixed(2)}`;
        });

        function editCost(id, currentData) {
            const newDesc = prompt('Edit description:', currentData.description);
            if (newDesc === null) return;

            const updateData = { description: newDesc };
            
            if (currentData.type === 'number') {
                const newAmount = parseFloat(prompt('Edit amount:', currentData.amount));
                if (!isNaN(newAmount)) {
                    updateData.amount = newAmount;
                }
            }

            tasksRef.doc(id).update(updateData)
                .catch(error => {
                    console.error("Error updating cost: ", error);
                });
        }

        function deleteCost(id) {
            if (confirm('Are you sure you want to delete this item?')) {
                tasksRef.doc(id).delete()
                    .catch(error => {
                        console.error("Error deleting cost: ", error);
                    });
            }
        }

        // Calculate total
        calculateBtn.addEventListener('click', function() {
            tasksRef.get().then(snapshot => {
                let total = 0;
                snapshot.forEach(doc => {
                    const cost = doc.data();
                    if (cost.type === 'number') {
                        total += cost.amount || 0;
                    }
                });
                alert(`Total costs: $${total.toFixed(2)}`);
            });
        });

        // Delete all costs with confirmation
        deleteAllBtn.addEventListener('click', function() {
            const confirmationCode = Math.floor(Math.random() * 1000 + 100);
            const userInput = prompt(`Type ${confirmationCode} to confirm deletion of ALL items:`);
            
            if (userInput && userInput === confirmationCode.toString()) {
                if (confirm('Are you REALLY sure? This cannot be undone!')) {
                    if (confirm('LAST WARNING! All your data will be gone!')) {
                        tasksRef.get().then(snapshot => {
                            const batch = db.batch();
                            snapshot.forEach(doc => {
                                batch.delete(doc.ref);
                            });
                            return batch.commit();
                        })
                        .then(() => {
                            alert('All data deleted successfully');
                        })
                        .catch(error => {
                            console.error("Error deleting data: ", error);
                        });
                    }
                }
            } else if (userInput !== null) {
                alert('Incorrect confirmation code. Deletion cancelled.');
            }
        });
    }

    // Sign out
    signOutBtn.addEventListener('click', function() {
        auth.signOut().catch(error => {
            console.error("Error signing out: ", error);
        });
    });

    // Auth State Observer
    auth.onAuthStateChanged((user) => {
        if (user) {
            authContainer.style.display = 'none';
            userContainer.style.display = 'block';
            if (userEmailElement) userEmailElement.textContent = user.email;
            initCostTracker(user);
        } else {
            authContainer.style.display = 'flex';
            userContainer.style.display = 'none';
        }
    });

    // Error Message Mapping
    function getErrorMessage(code) {
        const messages = {
            'auth/invalid-email': 'Invalid email address',
            'auth/user-disabled': 'Account disabled',
            'auth/user-not-found': 'Account not found',
            'auth/wrong-password': 'Incorrect password',
            'auth/email-already-in-use': 'Email already in use',
            'auth/operation-not-allowed': 'Operation not allowed',
            'auth/weak-password': 'Password is too weak',
            'auth/too-many-requests': 'Too many attempts. Try again later',
            'default': 'An error occurred. Please try again'
        };
        return messages[code] || messages['default'];
    }
});</script>
</body>
</html>
